<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Фронт + Бэк</title>
</head>

<body>
    <h1>Список пользователей</h1>
    <button id="loadBtn">Загрузить</button>
    <ul id="userList"></ul>

    <h2>Добавить пользователя</h2>
    <input id="nameInput" placeholder="Имя">
    <input id="ageInput" placeholder="Возраст" type="number">
    <button id="addBtn">Добавить</button>

    <script>

        const API_URL = "https://server-production-b587.up.railway.app/users";

        async function getUsers() {
            try {
                let res = await fetch(API_URL); // GET запрос
                let data = await res.json();
                console.log(data);


                const list = document.getElementById("userList");
                list.innerHTML = "";
                data.forEach(u => {
                    const li = document.createElement("li");
                    li.textContent = `${u.names} (${u.age})`;
                    list.appendChild(li);
                });
            } catch (err) {
                console.error("Ошибка:", err);
            }
        }

        async function addUser(newUser) {
            try {
                let res = await fetch(API_URL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(newUser)
                });

                let data = await res.json();
                console.log("Добавлен:", data);
                getUsers(); // обновить список
            } catch (err) {
                console.error("Ошибка:", err);
            }
        }

        document.getElementById("loadBtn").addEventListener("click", getUsers);
        document.getElementById("addBtn").addEventListener("click", () => {
            const name = document.getElementById("nameInput").value;
            const age = document.getElementById("ageInput").value;
            if (!name || !age) return alert("Введите имя и возраст!");
            addUser({ names: name, age: Number(age) });
        });

        getUsers();
    </script>
</body>

</html>